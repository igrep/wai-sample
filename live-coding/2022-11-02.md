# Haskellによるライブコーディング #59 複数の種類のレスポンス

実際に配信した動画: <https://www.youtube.com/watch?v=kLhBRQOkCFw>

## 📈本日の主な進捗

- 前回から引き続き、GHCを更新したことによる型エラーの修正
    - <https://github.com/igrep/wai-sample/commit/8a9ce9cae5935f28f4bbe1b1a5cd3881e38d3282>
- 型エラーが起こることをチェックするためのテストケースを追加してみてる
    - <https://github.com/igrep/wai-sample/commit/5d612e1cdcaf8344ecf52b46500ae9f6770298f9>

## ℹ️補足情報

### `{-# OPTIONS_GHC -fdefer-type-errors #-}`

言語拡張（`{-# LANGUAGE ...#-}`）と同じ要領でファイルの先頭に掲題のプラグマを書くと、そのファイルでは**型エラーが警告**として扱われるようになります。その代わり、実行時に型エラーが発生するコードを評価した時点で例外を投げるようになります。

こんなのなんのために使うの？というと、前回も紹介した`should-not-type-check`などと組み合わせて、「型エラーが起こることを期待するテスト」を書くのに使います。

## 次回（以降）

1. テストを追加で書きます
    - `defer-type-errors`、やはり結構扱いが難しく、思ったような所でエラーが出ないので、もう少し試してうまく行かなかったら諦めます。それほど型エラーで弾かなければならないケースでもないし...
1. まだTODOが残っているのでリファクタリングして直します
    - ちょっと考えましたが、`-- TODO: Overlappableにして、HasStatusCodeのインスタンスを逐一定義しなくてよくする（あるいは意識しなくてもよくする）。`の件は、書いたとおり`Overlappable`にするしかなさそうですね...
1. 次はレスポンスヘッダーですかね
